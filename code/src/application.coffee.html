---
layout: docco
title: mithgrid/code/src/application.coffee.html
---
<div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../index.html" class="source"><span class="file_name">README</span></a><a href="../src/application.coffee.html" class="source selected"><span class="base_path">src / </span><span class="file_name">application.coffee</span></a><a href="../src/controller.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">controller.coffee</span></a><a href="../src/core.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">core.coffee</span></a><a href="../src/data.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">data.coffee</span></a><a href="../src/expression.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">expression.coffee</span></a><a href="../src/facet.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">facet.coffee</span></a><a href="../src/intro.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">intro.coffee</span></a><a href="../src/outro.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">outro.coffee</span></a><a href="../src/plugin.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">plugin.coffee</span></a><a href="../src/presentation.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">presentation.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>application.coffee</h1><div class="filepath">src/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><h1>Applications</h1>

<h2>MITHGrid.Application.initInstance</h2>

<p>Initializes an application instance.</p>

<p>Parameters:</p>

<ul>
<li><p>klass -</p></li>
<li><p>container -</p></li>
<li><p>options -</p></li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">namespace</span> <span class="s">&#39;Application&#39;</span><span class="p">,</span> <span class="nf">(Application) -&gt;</span>
  <span class="nv">Application.initInstance = </span><span class="nf">(args...) -&gt;</span>   
    <span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">initInstance</span> <span class="s">&quot;MITHGrid.Application&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">...,</span> <span class="nf">(that, container) -&gt;</span>
      <span class="nv">onReady = </span><span class="p">[]</span>
  
      <span class="nv">that.presentation = </span><span class="p">{}</span>
      <span class="nv">that.facet = </span><span class="p">{}</span>
      <span class="nv">that.component = </span><span class="p">{}</span>
      <span class="nv">that.dataStore = </span><span class="p">{}</span>
      <span class="nv">that.dataView = </span><span class="p">{}</span>
      <span class="nv">that.controller = </span><span class="p">{}</span>
  
      <span class="nv">options = </span><span class="nx">that</span><span class="p">.</span><span class="nx">options</span>
    
      <span class="nv">configureInstance = </span><span class="o">-&gt;</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>The following configuration options are available:</p>

<h3>variables</h3>

<p>See the section on #addVariable.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">variables</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">varName</span><span class="p">,</span> <span class="nx">config</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">variables</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addVariable</span> <span class="nx">varName</span><span class="p">,</span> <span class="nx">config</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><h3>dataStores</h3>

<p>See the section on #addDataStore.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">dataStores</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">storeName</span><span class="p">,</span> <span class="nx">config</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">dataStores</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addDataStore</span> <span class="nx">storeName</span><span class="p">,</span> <span class="nx">config</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><h3>dataViews</h3>

<p>See the section on #addDataView.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">dataViews</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">viewName</span><span class="p">,</span> <span class="nx">viewConfig</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">dataViews</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addDataView</span> <span class="nx">viewName</span><span class="p">,</span> <span class="nx">viewConfig</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><h3>controllers</h3>

<p>See the section on #addController.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">controllers</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">cName</span><span class="p">,</span> <span class="nx">cconfig</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">controllers</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addController</span> <span class="nx">cName</span><span class="p">,</span> <span class="nx">cconfig</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><h3>viewSetup</h3>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">viewSetup</span><span class="o">?</span>
          <span class="k">if</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">viewSetup</span><span class="p">)</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">() -&gt;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">viewSetup</span> <span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">)</span>
          <span class="k">else</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">() -&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">append</span> <span class="nx">options</span><span class="p">.</span><span class="nx">viewSetup</span>
  </pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><h3>facets</h3>

<p>See the section on #addFacet.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">facets</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">fName</span><span class="p">,</span> <span class="nx">fconfig</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">facets</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addFacet</span> <span class="nx">fName</span><span class="p">,</span> <span class="nx">fconfig</span>
        </pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><h3>components</h3>

<p>See the section on #addComponent</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">components</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">cName</span><span class="p">,</span> <span class="nx">cconfig</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">components</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addComponent</span> <span class="nx">cName</span><span class="p">,</span> <span class="nx">cconfig</span>
          </pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><h3>presentations</h3>

<p>See the section on #addPresentation.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">presentations</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">pName</span><span class="p">,</span> <span class="nx">pconfig</span> <span class="k">of</span> <span class="nx">options</span><span class="p">.</span><span class="nx">presentations</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addPresentation</span> <span class="nx">pName</span><span class="p">,</span> <span class="nx">pconfig</span>
  </pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><h3>plugins</h3>

<p>See the section on #addPlugin.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">plugins</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">pconfig</span> <span class="k">in</span> <span class="nx">options</span><span class="p">.</span><span class="nx">plugins</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">addPlugin</span> <span class="nx">pconfig</span>
      
      <span class="nv">that.ready = </span><span class="nf">(fn) -&gt;</span> <span class="nx">onReady</span><span class="p">.</span><span class="nx">push</span> <span class="nx">fn</span>
  </pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><h3>#addVariable</h3>

<p>Adds a managed variable to the application object.</p>

<p>Parameters:</p>

<ul>
<li><p>varName - the name of the variable</p></li>
<li><p>config - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>

<p>Configuration:</p>

<ul>
<li><p><strong>is</strong> - the mutability of the variable is one of the following:</p>

<ul><li>'rw' for read-write</li>
<li>'r' for read-only</li>
<li>'w' for write-only.</li></ul></li>
<li><p><strong>event</strong> - the name of the event associated with this variable. This event will fire when the value of the variable changes.
      This defaults to 'on' + varName + 'Change'.</p></li>
<li><p><strong>setter</strong> - the name of the method that will be used to set the variable. This defaults to 'set' + varName.</p></li>
<li><p><strong>getter</strong> - the name of the method that will be used to retrieve the variable. This defaults to 'get' + varName.</p></li>
<li><p><strong>validate</strong> - a function that will be called to validate the value the variable is being set to. This function
         should expect the new value and return "true" or "false".</p></li>
<li><p><strong>filter</strong> - a function that will be called to filter the value the variable is being set to. This function
       should expect the new value and return the filtered value. If both the filter and validate
       options are set, the filter will be run before the validate function.</p></li>
</ul>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addVariable = </span><span class="nf">(varName, config) -&gt;</span>
        <span class="nv">value = </span><span class="nx">config</span><span class="p">.</span><span class="nx">default</span>
        <span class="nx">config</span><span class="p">.</span><span class="o">is</span> <span class="o">or=</span> <span class="s">&#39;rw&#39;</span>
        <span class="k">if</span> <span class="nx">config</span><span class="p">.</span><span class="o">is</span> <span class="k">in</span> <span class="p">[</span><span class="s">&#39;rw&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">]</span>
          <span class="nv">filter = </span><span class="nx">config</span><span class="p">.</span><span class="nx">filter</span>
          <span class="nv">validate = </span><span class="nx">config</span><span class="p">.</span><span class="nx">validate</span>
          <span class="nv">eventName = </span><span class="nx">config</span><span class="p">.</span><span class="nx">event</span> <span class="o">||</span> <span class="p">(</span><span class="s">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">varName</span> <span class="o">+</span> <span class="s">&#39;Change&#39;</span><span class="p">)</span>
          <span class="nv">setName = </span><span class="nx">config</span><span class="p">.</span><span class="nx">setter</span> <span class="o">||</span> <span class="p">(</span><span class="s">&#39;set&#39;</span> <span class="o">+</span> <span class="nx">varName</span><span class="p">)</span>
          <span class="nx">that</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">initEventFirer</span><span class="p">()</span>
          <span class="k">if</span> <span class="nx">filter</span><span class="o">?</span>
            <span class="k">if</span> <span class="nx">validate</span><span class="o">?</span>
              <span class="nx">that</span><span class="p">[</span><span class="nx">setName</span><span class="p">]</span> <span class="o">=</span> <span class="nf">(v) -&gt;</span>
                <span class="nv">v = </span><span class="nx">validate</span> <span class="nx">filter</span> <span class="nx">v</span>
                <span class="k">if</span> <span class="nx">value</span> <span class="o">!=</span> <span class="nx">v</span>
                  <span class="nv">value = </span><span class="nx">v</span>
                  <span class="nx">that</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">].</span><span class="nx">fire</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
            <span class="k">else</span>
              <span class="nx">that</span><span class="p">[</span><span class="nx">setName</span><span class="p">]</span> <span class="o">=</span> <span class="nf">(v) -&gt;</span>
                <span class="nv">v = </span><span class="nx">filter</span> <span class="nx">v</span>
                <span class="k">if</span> <span class="nx">value</span> <span class="o">!=</span> <span class="nx">v</span>
                  <span class="nv">value = </span><span class="nx">v</span>
                  <span class="nx">that</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">].</span><span class="nx">fire</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
          <span class="k">else</span>
            <span class="k">if</span> <span class="nx">validate</span><span class="o">?</span>
              <span class="nx">that</span><span class="p">[</span><span class="nx">setName</span><span class="p">]</span> <span class="o">=</span> <span class="nf">(v) -&gt;</span>
                <span class="nv">v = </span><span class="nx">validate</span> <span class="nx">v</span>
                <span class="k">if</span> <span class="nx">value</span> <span class="o">!=</span> <span class="nx">v</span>
                  <span class="nv">value = </span><span class="nx">v</span>
                  <span class="nx">that</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">].</span><span class="nx">fire</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
            <span class="k">else</span>
              <span class="nx">that</span><span class="p">[</span><span class="nx">setName</span><span class="p">]</span> <span class="o">=</span> <span class="nf">(v) -&gt;</span>
                <span class="k">if</span> <span class="nx">value</span> <span class="o">!=</span> <span class="nx">v</span>
                  <span class="nv">value = </span><span class="nx">v</span>
                  <span class="nx">that</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">].</span><span class="nx">fire</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">config</span><span class="p">.</span><span class="o">is</span> <span class="k">in</span> <span class="p">[</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;rw&#39;</span><span class="p">]</span>
          <span class="nv">getName = </span><span class="nx">config</span><span class="p">.</span><span class="nx">getter</span> <span class="o">||</span> <span class="p">(</span><span class="s">&#39;get&#39;</span> <span class="o">+</span> <span class="nx">varName</span><span class="p">)</span>
          <span class="nx">that</span><span class="p">[</span><span class="nx">getName</span><span class="p">]</span> <span class="o">=</span> <span class="nf">() -&gt;</span> <span class="nx">value</span>
  </pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><h3>#addDataStore</h3>

<p>Adds a data store to the application.</p>

<p>Parameters:</p>

<ul>
<li><p>storeName - name for the data store</p></li>
<li><p>config - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addDataStore = </span><span class="nf">(storeName, config) -&gt;</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><p>The data store automatically has an "Item" type and the "label", "type", and "id" properties.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="o">!</span><span class="nx">that</span><span class="p">.</span><span class="nx">dataStore</span><span class="p">[</span><span class="nx">storeName</span><span class="p">]</span><span class="o">?</span>
          <span class="nv">store = </span><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">initInstance</span><span class="p">()</span>
          <span class="nx">that</span><span class="p">.</span><span class="nx">dataStore</span><span class="p">[</span><span class="nx">storeName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">store</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">addType</span> <span class="s">&#39;Item&#39;</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">addProperty</span> <span class="s">&#39;label&#39;</span><span class="p">,</span>
            <span class="nv">valueType: </span><span class="s">&#39;text&#39;</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">addProperty</span> <span class="s">&#39;type&#39;</span><span class="p">,</span>
            <span class="nv">valueType: </span><span class="s">&#39;text&#39;</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">addProperty</span> <span class="s">&#39;id&#39;</span><span class="p">,</span>
            <span class="nv">valueType: </span><span class="s">&#39;text&#39;</span>
        <span class="k">else</span>
          <span class="nv">store = </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataStore</span><span class="p">[</span><span class="nx">storeName</span><span class="p">]</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>Configuration:</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><ul>
<li><strong>types</strong> - object having the types as keys. Types do not have configurations yet.</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">config</span><span class="o">?</span><span class="p">.</span><span class="nx">types</span><span class="o">?</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">addType</span> <span class="nx">type</span> <span class="k">for</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">typeInfo</span> <span class="k">of</span> <span class="nx">config</span><span class="p">.</span><span class="nx">types</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><ul>
<li><strong>properties</strong> - object having the properties as keys. Properties have the following options:
<ul><li>valueType - the type of value associated with the property. Value types should be one of the following:
<ul><li>text - plain text strings (default)</li>
<li>item - the id of an item in the data store</li>
<li>numeric - an integer or floating point number</li>
<li>date -</li>
<li>url -</li></ul></li></ul></li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">config</span><span class="o">?</span><span class="p">.</span><span class="nx">properties</span><span class="o">?</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">addProperty</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">propOptions</span> <span class="k">for</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">propOptions</span> <span class="k">of</span> <span class="nx">config</span><span class="p">.</span><span class="nx">properties</span>
  </pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><h3>#addDataView</h3>

<p>Adds a data view to the application.</p>

<p>Parameters:</p>

<ul>
<li><p>viewName - name for the data view</p></li>
<li><p>viewConfig - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>

<p>Configuration:</p>

<ul>
<li><p>type - the namespace holding the #initInstance function for the particular data view type for this data view.
     Defaults to MITHGrid.Data.View.</p></li>
<li><p>dataStore - the name of the already configured data store.</p></li>
</ul>

<p>See the documentation for the particular data view type for other configuration options.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addDataView = </span><span class="nf">(viewName, viewConfig) -&gt;</span>
        <span class="k">if</span> <span class="nx">viewConfig</span><span class="p">.</span><span class="nx">type</span><span class="o">?</span> <span class="o">and</span> <span class="nx">viewConfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initInstance</span><span class="o">?</span>
          <span class="nv">initFn = </span><span class="nx">viewConfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initInstance</span>
        <span class="k">else</span>
          <span class="nv">initFn = </span><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">initInstance</span>
        <span class="nv">viewOptions =</span>
          <span class="nv">dataStore: </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataStore</span><span class="p">[</span><span class="nx">viewConfig</span><span class="p">.</span><span class="nx">dataStore</span><span class="p">]</span> <span class="o">||</span> <span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">viewConfig</span><span class="p">.</span><span class="nx">dataStore</span><span class="p">]</span>
  
        <span class="k">if</span> <span class="o">!</span><span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">viewName</span><span class="p">]</span><span class="o">?</span>
          <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="nx">viewConfig</span>
            <span class="k">if</span> <span class="nx">k</span> <span class="o">!=</span> <span class="s">&quot;type&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">viewOptions</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span>
              <span class="nx">viewOptions</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span>
      
          <span class="nv">view = </span><span class="nx">initFn</span> <span class="nx">viewOptions</span>
          <span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">viewName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">view</span>
  </pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><h3>#addController</h3>

<p>Adds a controller to the application.</p>

<p>Parameters:</p>

<ul>
<li><p>cName - name for the controller</p></li>
<li><p>cconfig - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addController = </span><span class="nf">(cName, cconfig) -&gt;</span>
        <span class="nv">coptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">cconfig</span><span class="p">)</span>

        <span class="nv">coptions.application = </span><span class="nx">that</span>
        <span class="nv">controller = </span><span class="nx">cconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initController</span> <span class="nx">coptions</span>
        <span class="nx">that</span><span class="p">.</span><span class="nx">controller</span><span class="p">[</span><span class="nx">cName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">controller</span>
  </pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><h3>#addFacet</h3>

<p>Adds a facet to the application.</p>

<p>Parameters:</p>

<ul>
<li><p>fName - name of the facet</p></li>
<li><p>fconfig - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addFacet = </span><span class="nf">(fName, fconfig) -&gt;</span>
        <span class="nv">foptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">fconfig</span><span class="p">)</span>
        <span class="nx">that</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">() -&gt;</span>
          <span class="nv">fcontainer = </span><span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">fconfig</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span>
          <span class="nv">fcontainer = </span><span class="nx">fcontainer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">fcontainer</span><span class="p">)</span>
      
          <span class="nv">foptions.dataView = </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">fconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="p">]</span>
          <span class="nv">foptions.application = </span><span class="nx">that</span>
      
          <span class="nv">facet = </span><span class="nx">fconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initFacet</span> <span class="nx">fcontainer</span><span class="p">,</span> <span class="nx">foptions</span>
          <span class="nx">that</span><span class="p">.</span><span class="nx">facet</span><span class="p">[</span><span class="nx">fName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">facet</span>
          <span class="nx">facet</span><span class="p">.</span><span class="nx">selfRender</span><span class="p">()</span>
  </pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><h3>#addComponent</h3>

<p>Adds a component to the application. Components tie together renderings with controllers, but do not base
their DOM content on data. Components are good for things like bounding boxes used by a presentation, menus,
or other UI elements that might be considered chrome.</p>

<p>Parameters:</p>

<ul>
<li><p>cName - name of the component</p></li>
<li><p>cconfig - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addComponent = </span><span class="nf">(cName, pconfig) -&gt;</span>
        <span class="nv">coptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">cconfig</span><span class="p">)</span>
        <span class="nx">that</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">() -&gt;</span>
          <span class="nv">ccontainer = </span><span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">coptions</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span>
          <span class="nv">ccontainer = </span><span class="nx">ccontainer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">ccontainer</span><span class="p">)</span>
          <span class="nv">coptions.application = </span><span class="nx">that</span>
          <span class="k">if</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">components</span><span class="o">?</span>
            <span class="nv">coptions.components = </span><span class="p">{}</span>
            <span class="k">for</span> <span class="nx">ccName</span><span class="p">,</span> <span class="nx">cconfig</span> <span class="k">of</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">components</span>
              <span class="k">if</span> <span class="k">typeof</span> <span class="nx">cconfig</span> <span class="o">==</span> <span class="s">&quot;string&quot;</span>
                <span class="nx">coptions</span><span class="p">.</span><span class="nx">components</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">component</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span>
              <span class="k">else</span>
                <span class="nv">ccoptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">ccconfig</span><span class="p">)</span>
                <span class="nv">ccoptions.application = </span><span class="nx">that</span>
                <span class="nx">coptions</span><span class="p">.</span><span class="nx">components</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initInstance</span> <span class="nx">ccoptions</span>
          <span class="k">if</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">controllers</span><span class="o">?</span>
            <span class="nv">coptions.controllers = </span><span class="p">{}</span>
            <span class="k">for</span> <span class="nx">ccName</span><span class="p">,</span> <span class="nx">cconfig</span> <span class="k">of</span> <span class="nx">pconfig</span><span class="p">.</span><span class="nx">controllers</span>
              <span class="k">if</span> <span class="k">typeof</span> <span class="nx">cconfig</span> <span class="o">==</span> <span class="s">&quot;string&quot;</span>
                <span class="nx">coptions</span><span class="p">.</span><span class="nx">controllers</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">controller</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span>
              <span class="k">else</span>
                <span class="nv">ccoptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">ccconfig</span><span class="p">)</span>
                <span class="nv">ccoptions.application = </span><span class="nx">that</span>
                <span class="nx">coptions</span><span class="p">.</span><span class="nx">controllers</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initController</span> <span class="nx">ccoptions</span>

          <span class="nx">that</span><span class="p">.</span><span class="nx">component</span><span class="p">[</span><span class="nx">cName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initInstance</span> <span class="nx">ccontainer</span><span class="p">,</span> <span class="nx">coptions</span>
        </pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><h3>#addPresentation</h3>

<p>Adds a presentation to the application.</p>

<p>Parameters:</p>

<ul>
<li><p>pName - name of the presentation</p></li>
<li><p>pconfig - object holding configuration options</p></li>
</ul>

<p>Returns: Nothing.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addPresentation = </span><span class="nf">(pName, pconfig) -&gt;</span>
        <span class="nv">poptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">pconfig</span><span class="p">)</span>
        <span class="nx">that</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">() -&gt;</span>
          <span class="nv">pcontainer = </span><span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">poptions</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span>
          <span class="nv">pcontainer = </span><span class="nx">pcontainer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">pcontainer</span><span class="p">)</span>
          <span class="nv">poptions.dataView = </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">pconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="p">]</span>
          <span class="nv">poptions.application = </span><span class="nx">that</span>
          <span class="k">if</span> <span class="nx">pconfig</span><span class="p">.</span><span class="nx">components</span><span class="o">?</span>
            <span class="nv">poptions.components = </span><span class="p">{}</span>
            <span class="k">for</span> <span class="nx">ccName</span><span class="p">,</span> <span class="nx">cconfig</span> <span class="k">of</span> <span class="nx">pconfig</span><span class="p">.</span><span class="nx">components</span>
              <span class="k">if</span> <span class="k">typeof</span> <span class="nx">cconfig</span> <span class="o">==</span> <span class="s">&quot;string&quot;</span>
                <span class="nx">poptions</span><span class="p">.</span><span class="nx">components</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">component</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span>
              <span class="k">else</span>
                <span class="nv">ccoptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">ccconfig</span><span class="p">)</span>
                <span class="nv">ccoptions.application = </span><span class="nx">that</span>
                <span class="nx">poptions</span><span class="p">.</span><span class="nx">components</span><span class="p">[</span><span class="nx">ccName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initInstance</span> <span class="nx">ccoptions</span>
          <span class="k">if</span> <span class="nx">pconfig</span><span class="p">.</span><span class="nx">controllers</span><span class="o">?</span>
            <span class="nv">poptions.controllers = </span><span class="p">{}</span>
            <span class="k">for</span> <span class="nx">cName</span><span class="p">,</span> <span class="nx">cconfig</span> <span class="k">of</span> <span class="nx">pconfig</span><span class="p">.</span><span class="nx">controllers</span>
              <span class="k">if</span> <span class="k">typeof</span> <span class="nx">cconfig</span> <span class="o">==</span> <span class="s">&quot;string&quot;</span>
                <span class="nx">poptions</span><span class="p">.</span><span class="nx">controllers</span><span class="p">[</span><span class="nx">cName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">controller</span><span class="p">[</span><span class="nx">cName</span><span class="p">]</span>
              <span class="k">else</span>
                <span class="nv">coptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">cconfig</span><span class="p">)</span>
                <span class="nv">coptions.application = </span><span class="nx">that</span>
                <span class="nx">poptions</span><span class="p">.</span><span class="nx">controllers</span><span class="p">[</span><span class="nx">cName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initController</span> <span class="nx">coptions</span>
    
          <span class="nv">presentation = </span><span class="nx">pconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initPresentation</span> <span class="nx">pcontainer</span><span class="p">,</span> <span class="nx">poptions</span>
          <span class="nx">that</span><span class="p">.</span><span class="nx">presentation</span><span class="p">[</span><span class="nx">pName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">presentation</span>
          <span class="nx">presentation</span><span class="p">.</span><span class="nx">selfRender</span><span class="p">()</span>
      </pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><h3>#addPlugin</h3>

<p>Adds a plugin to the application.</p>

<p>Parameters:</p>

<ul>
<li>pconf - object holding configuration options</li>
</ul>

<p>Returns: Nothing.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.addPlugin = </span><span class="nf">(pconf) -&gt;</span>
        <span class="nv">pconfig = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">pconf</span><span class="p">)</span>
        <span class="nv">pconfig.application = </span><span class="nx">that</span>

        <span class="nv">plugin = </span><span class="nx">pconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initPlugin</span><span class="p">(</span><span class="nx">pconfig</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">plugin</span><span class="o">?</span>
          <span class="k">if</span> <span class="nx">pconfig</span><span class="o">?</span><span class="p">.</span><span class="nx">dataView</span><span class="o">?</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><p>hook plugin up with dataView requested by app configuration</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nv">plugin.dataView = </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">pconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="p">]</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>add</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">plugin</span><span class="p">.</span><span class="nx">dataView</span><span class="p">.</span><span class="nx">addType</span> <span class="nx">type</span> <span class="k">for</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">typeInfo</span> <span class="k">of</span> <span class="nx">plugin</span><span class="p">.</span><span class="nx">getTypes</span><span class="p">()</span>

            <span class="nx">plugin</span><span class="p">.</span><span class="nx">dataView</span><span class="p">.</span><span class="nx">addProperty</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">propOptions</span> <span class="k">for</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">propOptions</span> <span class="k">of</span> <span class="nx">plugin</span><span class="p">.</span><span class="nx">getProperties</span><span class="p">()</span>

          <span class="k">for</span> <span class="nx">pname</span><span class="p">,</span> <span class="nx">prconfig</span> <span class="k">of</span> <span class="nx">plugin</span><span class="p">.</span><span class="nx">getPresentations</span><span class="p">()</span>
            <span class="nf">(pname, prconfig) -&gt;</span>
              <span class="nx">that</span><span class="p">.</span><span class="nx">ready</span> <span class="o">-&gt;</span>
                <span class="nv">proptions = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">prconfig</span><span class="p">.</span><span class="nx">options</span><span class="p">)</span>
                <span class="nv">pcontainer = </span><span class="nx">$</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">prconfig</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span></pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><p>pcontainer = $("#" + $(container).attr('id') + ' > ' + prconfig.container)</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nv">pcontainer = </span><span class="nx">pcontainer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">pcontainer</span><span class="p">)</span>

                <span class="nv">proptions.lenses = </span><span class="nx">prconfig</span><span class="p">.</span><span class="nx">lenses</span> <span class="k">if</span> <span class="nx">prconfig</span><span class="o">?</span><span class="p">.</span><span class="nx">lenses</span><span class="o">?</span>
                <span class="k">if</span> <span class="nx">prconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="o">?</span>
                  <span class="nv">proptions.dataView = </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">prconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="p">]</span> 
                <span class="k">else</span> <span class="k">if</span> <span class="nx">pconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="o">?</span>
                  <span class="nv">proptions.dataView = </span><span class="nx">that</span><span class="p">.</span><span class="nx">dataView</span><span class="p">[</span><span class="nx">pconfig</span><span class="p">.</span><span class="nx">dataView</span><span class="p">]</span>
                <span class="nv">proptions.application = </span><span class="nx">that</span>
                <span class="nv">presentation = </span><span class="nx">prconfig</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">initPresentation</span> <span class="nx">pcontainer</span><span class="p">,</span> <span class="nx">proptions</span>
                <span class="nx">plugin</span><span class="p">.</span><span class="nx">presentation</span><span class="p">[</span><span class="nx">pname</span><span class="p">]</span> <span class="o">=</span> <span class="nx">presentation</span>
                <span class="nx">presentation</span><span class="p">.</span><span class="nx">selfRender</span><span class="p">()</span>
  
  
      <span class="nx">configureInstance</span><span class="p">()</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><h3>#run</h3>

<p>Finishes configuring the application by running all queued or pending functions registered through
the #ready() method. The #ready() method will be redefined to run functions after the current thread
finishes.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">that.run = </span><span class="nf">() -&gt;</span>
        <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span> <span class="nf">() -&gt;</span>
          <span class="nx">fn</span><span class="p">()</span> <span class="k">for</span> <span class="nx">fn</span> <span class="k">in</span> <span class="nx">onReady</span>            
          <span class="nv">onReady = </span><span class="p">[]</span>
          <span class="nv">that.ready = </span><span class="nf">(fn) -&gt;</span> <span class="nx">fn</span><span class="p">()</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Sat Apr 28 2012 20:09:57 GMT-0400 (EDT)  </div><div id="projectname"><a href="../index.html">MITHgrid</a></div></div>